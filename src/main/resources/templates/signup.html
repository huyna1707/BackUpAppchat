<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đăng Ký - Professional Registration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .input-focus:focus {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .btn-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }
        .floating-shapes { position: absolute; width: 100%; height: 100%; overflow: hidden; z-index: 0; }
        .shape { position: absolute; border-radius: 50%; background: rgba(255, 255, 255, 0.1); animation: float 6s ease-in-out infinite; }
        .shape:nth-child(1) { width: 80px; height: 80px; top: 20%; left: 10%; animation-delay: 0s; }
        .shape:nth-child(2) { width: 120px; height: 120px; top: 60%; right: 10%; animation-delay: 2s; }
        .shape:nth-child(3) { width: 60px; height: 60px; bottom: 20%; left: 20%; animation-delay: 4s; }
        @keyframes float { 0%, 100% { transform: translateY(0) rotate(0); } 50% { transform: translateY(-20px) rotate(180deg); } }
        .slide-in { animation: slideIn 0.8s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .error-message { color: #ef4444; font-size: 0.875rem; margin-top: 0.25rem; }
        .success-message { color: #10b981; font-size: 0.875rem; margin-top: 0.25rem; }
    </style>
</head>
<body class="gradient-bg min-h-screen flex items-center justify-center p-4 relative">
<!-- Floating Background Shapes -->
<div class="floating-shapes">
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
</div>

<!-- Registration Card -->
<div class="glass-effect rounded-3xl shadow-2xl p-8 w-full max-w-lg relative z-10 slide-in">
    <div class="text-center mb-8">
        <div class="w-16 h-16 bg-gradient-to-r from-green-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
            <i class="fas fa-user-plus text-white text-2xl"></i>
        </div>
        <h1 class="text-3xl font-bold text-gray-800 mb-2">Tạo tài khoản mới</h1>
        <p class="text-gray-600">Điền thông tin để bắt đầu</p>
    </div>

    <form method="POST" th:action="@{/signup}" th:object="${form}" class="space-y-6">
        <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

        <div th:if="${#fields.hasErrors()}" class="p-3 rounded-lg bg-red-50 border border-red-200 text-red-700">
            <ul class="list-disc list-inside">
                <li th:each="e: ${#fields.errors('*')}" th:text="${e}"></li>
            </ul>
        </div>

        <div class="relative">
            <label class="block text-sm font-medium text-gray-700 mb-2">Tên đăng nhập</label>
            <input type="text" th:field="*{username}" class="input-focus w-full py-3 px-4 border rounded-xl bg-white/80" placeholder="Tên đăng nhập" required />
            <div class="error-message" th:if="${#fields.hasErrors('username')}" th:errors="*{username}"></div>
        </div>

        <div class="relative">
            <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
            <input type="email" th:field="*{email}" class="input-focus w-full py-3 px-4 border rounded-xl bg-white/80" placeholder="Email" required />
            <div class="error-message" th:if="${#fields.hasErrors('email')}" th:errors="*{email}"></div>
        </div>

        <div class="relative">
            <label class="block text-sm font-medium text-gray-700 mb-2">Mật khẩu</label>
            <input type="password" th:field="*{password}" class="input-focus w-full py-3 px-4 border rounded-xl bg-white/80" placeholder="Mật khẩu" required />
            <div class="error-message" th:if="${#fields.hasErrors('password')}" th:errors="*{password}"></div>
        </div>
        <div class="relative">
            <label class="block text-sm font-medium text-gray-700 mb-2">Xác nhận mật khẩu</label>
            <input type="password" th:field="*{confirmPassword}" class="input-focus w-full py-3 px-4 border rounded-xl bg-white/80" placeholder="Nhập lại mật khẩu" required />
            <div class="error-message" th:if="${#fields.hasErrors('confirmPassword')}" th:errors="*{confirmPassword}"></div>
        </div>

        <div class="flex items-start space-x-3">
            <input type="checkbox" id="terms" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 mt-1" required>
            <label for="terms" class="text-sm text-gray-600 leading-relaxed">
                Tôi đồng ý với <a href="#" class="text-blue-600 hover:text-blue-800 font-medium">Điều khoản</a> và <a href="#" class="text-blue-600 hover:text-blue-800 font-medium">Chính sách</a>
            </label>
        </div>

        <!-- Nút submit -->
        <button type="submit" class="btn-hover w-full bg-gradient-to-r from-green-500 to-blue-600 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 flex items-center justify-center space-x-2 shadow-lg">
            <span>Đăng ký</span>
        </button>

        <!-- Thành công -->
        <div id="signupSuccess" class="hidden" th:if="${success}" th:data-msg="${success}"></div>
        <!-- Thất bại -->
        <div id="serverErrors" class="hidden" th:if="${#fields.hasErrors()}">
            <ul>
                <li th:each="e : ${#fields.errors('*')}" th:text="${e}"></li>
            </ul>
        </div>
    </form>

    <div class="mt-8 text-center">
        <p class="text-gray-600">
            Đã có tài khoản? <a href="/login" class="text-blue-600 hover:text-blue-800 font-semibold">Đăng nhập ngay</a>
        </p>
    </div>
</div>

<script>
    (function () {
        const successBox = document.getElementById('signupSuccess');
        if (successBox) {
            Swal.fire({
                icon: 'success',
                title: 'Thành công!',
                text: successBox.dataset.msg,
                confirmButtonColor: '#10b981'
            });
        }

        const errorBox = document.getElementById('serverErrors');
        if (errorBox) {
            Swal.fire({
                icon: 'error',
                title: 'Đăng ký thất bại',
                html: errorBox.innerHTML,
                confirmButtonColor: '#ef4444'
            });
        }
    })();
</script>
</body>
</html>
